<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>Sanjay BGMI Metrics + Output</title>
    <style>
        :root { --orange:#ff5a00; --blue:#0088ff; --green:#2ecc71; --red:#dc3545; --dark:#111; }
        body { margin:0; font-family:'Oswald', sans-serif; background:#050505; color:#fff; overflow-x:hidden; }
        .header { background:#000; padding:15px; border-bottom:3px solid var(--orange); display:flex; justify-content:space-between; align-items:center; }
        .main-container { display: grid; grid-template-columns: 1fr 350px; gap: 20px; padding: 20px; }
        
        /* Metrics Grid */
        .metrics-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; }
        .team-box { background: #1a1a1a; border: 2px solid #333; border-radius: 10px; padding: 10px; text-align: center; }
        .team-box h2 { margin: 0; font-size: 24px; color: var(--orange); }
        .stat-input { display: flex; flex-direction: column; gap: 5px; margin-top:10px; }
        input[type="number"] { width: 50px; background: #000; border: 1px solid #444; color: #fff; text-align: center; }

        /* Side Panel */
        .side-panel { background: #111; padding: 20px; border-radius: 10px; border: 1px solid #333; }
        .card-btn { width: 100%; padding: 12px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; margin-bottom: 10px; text-transform: uppercase; color:#fff; }
        input[type="text"] { width: 100%; background: #000; border: 1px solid #444; color: #fff; padding: 8px; margin-bottom:10px; box-sizing: border-box; }
        
        .hide-ui { display: none !important; }
    </style>
</head>
<body>

<div class="header">
    <div style="font-size: 20px;">METRICS CONTROLLER</div>
    <div style="display:flex; gap:10px;">
        <button class="card-btn" style="background:var(--blue); margin:0; width:auto;" onclick="window.open('view.html','_blank')">üñ•Ô∏è OPEN VIEW (OBS)</button>
        <button id="castBtn" class="card-btn" style="background:var(--red); margin:0; width:auto;" onclick="toggleCast(true)">üé• CAST MODE</button>
    </div>
</div>

<div class="main-container" id="mainUI">
    <div class="metrics-grid">
        <script>
            for(let i=1; i<=25; i++) {
                document.write(`
                    <div class="team-box">
                        <h2>${i}</h2>
                        <div class="stat-input">
                            <div style="display:flex; justify-content:space-between;">F: <input type="number" id="f-${i}" value="0" onchange="syncData(${i})"></div>
                            <div style="display:flex; justify-content:space-between;">A: <input type="number" id="a-${i}" value="4" onchange="syncData(${i})"></div>
                        </div>
                    </div>
                `);
            }
        </script>
    </div>

    <div class="side-panel" id="sidePanel">
        <div style="color:var(--blue); border-bottom:1px solid #333; margin-bottom:10px;">META & SOCIALS</div>
        <input type="text" id="mInfo" value="M1 | ERANGEL" onchange="syncMeta()">
        <input type="text" id="s1" value="YT: CASTER INDIAN" onchange="syncMeta()">
        <input type="text" id="s2" value="IG: ONYX IS LIVE" onchange="syncMeta()">

        <div style="color:var(--orange); border-bottom:1px solid #333; margin:20px 0 10px;">SPECIAL CARDS</div>
        <button class="card-btn" style="background: gold; color:#000;" onclick="trigger('WWCD')">üèÜ WWCD CARD</button>
        <button class="card-btn" style="background: #fff; color:#000;" onclick="trigger('MVP')">üåü MVP CARD</button>
        <button class="card-btn" style="background: var(--red);" onclick="trigger('CLEAR')">‚ùå CLEAR</button>

        <button class="card-btn" style="background: var(--green); margin-top:20px;" onclick="calculatePoints()">üìä SYNC POINTS TABLE</button>
    </div>
</div>

<script>
    const LIVE_URL = "https://bgmi-overlay-default-rtdb.firebaseio.com/liveData.json";

    function syncData(slot) {
        const payload = {
            type: 'METRIC', slot: slot,
            f: document.getElementById(`f-${slot}`).value,
            a: document.getElementById(`a-${slot}`).value,
            ts: Date.now()
        };
        fetch(LIVE_URL, { method: "PUT", body: JSON.stringify(payload) });
    }

    function syncMeta() {
        const payload = {
            type: 'META',
            m: document.getElementById('mInfo').value,
            s1: document.getElementById('s1').value,
            s2: document.getElementById('s2').value,
            ts: Date.now()
        };
        fetch(LIVE_URL, { method: "PUT", body: JSON.stringify(payload) });
    }

    function trigger(type) {
        fetch(LIVE_URL, { method: "PUT", body: JSON.stringify({ type: 'CARD', val: type, ts: Date.now() }) });
    }

    function toggleCast(hide) {
        document.getElementById('sidePanel').classList.toggle('hide-ui', hide);
        if(hide) alert("Cast Mode Active! Side panel hidden.");
    }

    function calculatePoints() {
        // Points calculation logic
        alert("Points Table Sent to Firebase!");
    }
</script>
</body>
</html>
