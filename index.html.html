<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BGMI Studio v44.0 - Full Control</title>
    <script src="https://unpkg.com/interactjs/dist/interact.min.js"></script>
    <style>
        :root {
            --rank-bg: #0e1236; --row-bg: #ffffff; --text-color: #000000;
            --total-bg: #00e5ff; --elim-bg: #222222; --row-gap: 2px; --fade-op: 0.4;
            --w-rank: 45px; --w-logo: 50px; --w-name: 200px; --w-status: 100px; --w-fin: 50px; --w-tot: 65px;
            --bar-w: 3px; --bar-h: 16px; --bar-gap: 2px;
        }
        body { margin: 0; background: #00ff00; font-family: 'Bahnschrift', sans-serif; overflow: hidden; }

        /* Admin UI */
        #admin { width: 320px; height: 100vh; background: #111; position: fixed; left: 0; padding: 15px; border-right: 2px solid #333; z-index: 9999; overflow-y: auto; color: white; font-size: 11px; }
        .config-sec { background: #1a1a1a; padding: 10px; margin-bottom: 12px; border-radius: 4px; border-top: 2px solid var(--total-bg); }
        .config-sec h4 { margin: 0 0 8px 0; color: var(--total-bg); text-transform: uppercase; font-size: 10px; }
        label { display: block; margin-top: 5px; color: #888; }
        input[type="range"] { width: 100%; accent-color: var(--total-bg); }
        .btn-main { background: var(--total-bg); color: #000; width: 100%; padding: 10px; border:none; font-weight: 900; cursor: pointer; border-radius: 4px; text-transform: uppercase; }

        /* Leaderboard Table Logic */
        .movable { position: absolute; touch-action: none; cursor: move; z-index: 500; }
        .lb-container { display: table; border-collapse: separate; border-spacing: 0 var(--row-gap); }
        .lb-row { display: table-row; background: var(--row-bg); color: var(--text-color); font-weight: 900; transition: background 0.3s, opacity 0.3s; }
        
        /* Fixed Elimination Fade */
        .lb-row.eliminated { 
            background: var(--elim-bg) !important; 
            opacity: var(--fade-op) !important; 
            color: rgba(255,255,255,0.7) !important; 
        }
        .lb-row.eliminated .col-tot { background: #333 !important; color: #666 !important; }
        .lb-row.eliminated .v-bar { background: #444 !important; opacity: 0.1; }

        .cell { display: table-cell; vertical-align: middle; height: 35px; padding: 0; margin: 0; overflow: hidden; }
        .col-rank { width: var(--w-rank); background: var(--rank-bg); color: white; text-align: center; font-size: 16px; }
        .col-logo { width: var(--w-logo); background: #fff; text-align: center; line-height: 0; }
        .col-logo img { height: 24px; width: 24px; object-fit: contain; vertical-align: middle; }
        .col-name { width: var(--w-name); padding-left: 10px; text-transform: uppercase; white-space: nowrap; font-size: 14px; }
        .col-status { width: var(--w-status); text-align: center; border-left: 1px solid rgba(0,0,0,0.1); }
        .col-fin { width: var(--w-fin); text-align: center; border-left: 1px solid rgba(0,0,0,0.1); }
        .col-tot { width: var(--w-tot); background: var(--total-bg); color: #000; text-align: center; font-size: 18px; border-left: 1px solid rgba(0,0,0,0.1); }
        
        /* Alive Bars */
        .v-bar { display: inline-block; width: var(--bar-w); height: var(--bar-h); background: var(--rank-bg); border-radius: 1px; margin: 0 var(--bar-gap); vertical-align: middle; }
        .v-bar.dead { background: #cbd5e0; opacity: 0.15; }

        /* Elimination Popup */
        #alert { width: 380px; height: 95px; background: #1a0505; border-bottom: 5px solid #ff9d00; display: none; z-index: 10000; position: relative; color: white; }
        .alert-tag { position: absolute; top: 0; left: 0; background: #ff9d00; color: #000; padding: 2px 10px; font-weight: 900; clip-path: polygon(0 0, 100% 0, 80% 100%, 0% 100%); font-size: 10px; }
    </style>
</head>
<body>

<div id="admin">
    <button class="btn-main" onclick="toggleM()">‚öôÔ∏è SETUP TEAMS</button>
    
    <div class="config-sec">
        <h4>üé® Color & Fade Control</h4>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px;">
            <div>Row <input type="color" value="#ffffff" oninput="adj('row-bg', this.value)"></div>
            <div>Total <input type="color" value="#00e5ff" oninput="adj('total-bg', this.value)"></div>
            <div>Rank <input type="color" value="#0e1236" oninput="adj('rank-bg', this.value)"></div>
            <div>Elim <input type="color" value="#222222" oninput="adj('elim-bg', this.value)"></div>
        </div>
        <label>Fade Transparency (Opacity)</label>
        <input type="range" min="0" max="100" value="40" oninput="adj('fade-op', this.value/100)">
    </div>

    <div class="config-sec">
        <h4>‚ö° Thin Alive Bars</h4>
        <label>Width</label><input type="range" min="1" max="10" value="3" oninput="adj('bar-w', this.value+'px')">
        <label>Height</label><input type="range" min="5" max="30" value="16" oninput="adj('bar-h', this.value+'px')">
        <label>Gap</label><input type="range" min="0" max="8" value="2" oninput="adj('bar-gap', this.value+'px')">
    </div>

    <div class="config-sec">
        <h4>‚ÜîÔ∏è Column Adjustments</h4>
        <label>Rank Box</label><input type="range" min="10" max="120" value="45" oninput="adj('w-rank', this.value+'px')">
        <label>Logo Box</label><input type="range" min="10" max="120" value="50" oninput="adj('w-logo', this.value+'px')">
        <label>Name Box</label><input type="range" min="50" max="500" value="200" oninput="adj('w-name', this.value+'px')">
        <label>Status Box</label><input type="range" min="20" max="200" value="100" oninput="adj('w-status', this.value+'px')">
        <label>Finish Box</label><input type="range" min="10" max="120" value="50" oninput="adj('w-fin', this.value+'px')">
        <label>Total Box</label><input type="range" min="20" max="200" value="65" oninput="adj('w-tot', this.value+'px')">
        <label>Vertical Row Gap</label><input type="range" min="0" max="25" value="2" oninput="adj('row-gap', this.value+'px')">
    </div>

    <div id="ctrl-list"></div>
</div>

<div id="board" class="movable lb-container" style="top: 50px; left: 350px;">
    <div id="board-rows"></div>
</div>

<div id="alert" class="movable" style="top: 40%; left: 50%; transform: translateX(-50%);">
    <div class="alert-tag">TEAM ELIMINATED</div>
    <div style="display:flex; height:100%;">
        <div style="width:90px; background:#000; display:flex; align-items:center; justify-content:center;"><img id="a-img" src="" style="width:60px;"></div>
        <div style="flex:1; background:#111; padding:15px;">
            <div id="a-name" style="font-size:22px; font-weight:900; text-transform:uppercase;">TEAM NAME</div>
            <div style="display:flex; gap:20px; margin-top:5px; border-top:1px solid #333; padding-top:5px;">
                <div>RANK <span id="a-rank" style="color:#ff9d00;">#0</span></div>
                <div>FINISHES <span id="a-fin" style="color:#ff9d00;">0</span></div>
            </div>
        </div>
    </div>
</div>

<div id="modal" style="position:fixed; top:5%; left:5%; width:90%; height:85%; background:#111; padding:20px; border:1px solid var(--total-bg); display:none; z-index:10001; color: white; overflow-y:auto;">
    <h3>Team Data Entry</h3>
    <div id="set-inputs"></div>
    <button onclick="addT()" style="background:green; color:white; border:none; padding:10px; cursor:pointer;">+ ADD NEW TEAM</button>
    <button onclick="saveS()" class="btn-main" style="margin-top:20px;">SAVE ALL & REFRESH</button>
</div>

<script>
    let teams = JSON.parse(localStorage.getItem('bgmi_v44')) || [];
    const posPoints = {1:10, 2:6, 3:5, 4:4, 5:3, 6:2, 7:1, 8:1};

    // DRAG LOGIC RESTORED
    interact('.movable').draggable({
        listeners: { move (e) {
            let t = e.target;
            let x = (parseFloat(t.dataset.x) || 0) + e.dx;
            let y = (parseFloat(t.dataset.y) || 0) + e.dy;
            t.style.transform = `translate(${x}px, ${y}px)`;
            t.dataset.x = x; t.dataset.y = y;
        }}
    });

    function adj(p, v) { document.documentElement.style.setProperty('--'+p, v); }

    function render() {
        const rows = document.getElementById('board-rows');
        const ctrl = document.getElementById('ctrl-list');
        rows.innerHTML = ''; ctrl.innerHTML = '';

        let sorted = [...teams].sort((a,b) => (b.kills + b.autoPlace + b.basePts) - (a.kills + a.autoPlace + a.basePts));

        sorted.forEach((t, i) => {
            let bars = '';
            for(let j=1; j<=4; j++) bars += `<div class="v-bar ${j<=t.alive?'':'dead'}"></div>`;
            rows.innerHTML += `
                <div class="lb-row ${t.dead ? 'eliminated' : ''}">
                    <div class="cell col-rank">${i+1}</div>
                    <div class="cell col-logo"><img src="${t.logo}"></div>
                    <div class="cell col-name">${t.name}</div>
                    <div class="cell col-status">${bars}</div>
                    <div class="cell col-fin">${t.kills}</div>
                    <div class="cell col-tot">${t.kills + t.autoPlace + t.basePts}</div>
                </div>`;
        });

        teams.forEach((t, i) => {
            ctrl.innerHTML += `<div style="background:#222; padding:5px; margin-bottom:4px; display:flex; gap:5px; align-items:center;">
                <b style="flex:1; font-size:9px;">${t.name}</b>
                K:<input type="number" style="width:30px" value="${t.kills}" onchange="upd(${i},'kills',this.value)">
                <input type="checkbox" ${t.dead?'checked':''} onchange="triggerElim(${i}, this.checked)"> ELIM
            </div>`;
        });
        localStorage.setItem('bgmi_v44', JSON.stringify(teams));
    }

    function triggerElim(i, isChecked) {
        if(isChecked) {
            let aliveNow = teams.filter(t => !t.dead).length;
            teams[i].autoPlace = posPoints[aliveNow] || 0;
            showPop(teams[i], aliveNow);
            teams[i].dead = true;
            teams[i].alive = 0;
        } else {
            teams[i].dead = false;
            teams[i].autoPlace = 0;
            teams[i].alive = 4;
        }
        render();
    }

    function upd(i, k, v) { teams[i][k] = parseInt(v) || 0; render(); }
    function showPop(team, rank) {
        const a = document.getElementById('alert');
        document.getElementById('a-img').src = team.logo;
        document.getElementById('a-name').innerText = team.name;
        document.getElementById('a-rank').innerText = "#" + rank;
        document.getElementById('a-fin').innerText = team.kills;
        a.style.display = 'block';
        setTimeout(() => a.style.display = 'none', 6000);
    }
    function toggleM() {
        const m = document.getElementById('modal');
        m.style.display = (m.style.display === 'block') ? 'none' : 'block';
        if(m.style.display === 'block') {
            const box = document.getElementById('set-inputs'); box.innerHTML = '';
            teams.forEach((t, i) => {
                box.innerHTML += `<div style="display:flex; gap:5px; margin-bottom:5px;">
                    <input type="text" id="n-${i}" value="${t.name}">
                    <input type="text" id="l-${i}" value="${t.logo}" style="flex:1">
                    <input type="number" id="p-${i}" value="${t.basePts}" style="width:50px">
                    <button onclick="delT(${i})" style="color:red">DEL</button>
                </div>`;
            });
        }
    }
    function addT() { teams.push({ name: 'TEAM', logo: 'https://i.ibb.co/VWVx67n/default.png', kills: 0, basePts: 0, autoPlace: 0, alive: 4, dead: false }); render(); toggleM(); toggleM(); }
    function delT(i) { teams.splice(i, 1); render(); toggleM(); toggleM(); }
    function saveS() {
        teams.forEach((t, i) => {
            t.name = document.getElementById(`n-${i}`).value.toUpperCase();
            t.logo = document.getElementById(`l-${i}`).value;
            t.basePts = parseInt(document.getElementById(`p-${i}`).value) || 0;
        });
        document.getElementById('modal').style.display = 'none'; render();
    }
    render();
</script>
</body>
</html>