<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BGMI Ultimate Overlay</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap" rel="stylesheet">
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            background: #00ff00; /* Pure Green Screen */
            font-family: 'Oswald', sans-serif;
            width: 1920px;
            height: 1080px;
            overflow: hidden;
            position: relative;
        }

        /* 1. ALIVE STATUS (Top Left) */
        #alive-status {
            position: absolute;
            top: 40px;
            left: 40px;
            display: flex;
            gap: 15px;
        }
        .status-box {
            background: rgba(21, 25, 29, 0.9);
            padding: 10px 25px;
            border-bottom: 4px solid #00f2ff;
            border-radius: 4px;
            text-align: center;
        }
        .status-val { color: #00f2ff; font-size: 35px; line-height: 1; }
        .status-lbl { color: white; font-size: 14px; text-transform: uppercase; }

        /* 2. ELIMINATION POPUP (Top Middle) */
        #elim-container {
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: none;
        }
        .elim-card {
            display: flex;
            background: #15191d;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
            min-width: 450px;
            border-bottom: 4px solid #00f2ff;
            animation: dropDown 0.5s ease-out;
        }
        .logo-box { background: white; width: 100px; display: flex; justify-content: center; align-items: center; }
        .logo-box img { width: 70px; height: 70px; object-fit: contain; }
        .info-box { padding: 15px 25px; flex-grow: 1; }
        .team-name { font-size: 28px; color: white; margin: 0; }
        .status-txt { color: #00f2ff; font-size: 18px; }
        .fin-box { background: #252c33; padding: 10px 20px; text-align: center; }
        .fin-val { color: #2b7fff; font-size: 35px; display: block; }

        /* 3. WINNING PREDICTION (Bottom Right) */
        #prediction-box {
            position: absolute;
            bottom: 40px;
            right: 40px;
            background: rgba(21, 25, 29, 0.9);
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #ffaa00;
            width: 250px;
        }
        .pred-title { color: #ffaa00; font-size: 14px; margin-bottom: 5px; }
        .pred-team { color: white; font-size: 20px; display: flex; align-items: center; gap: 10px; }
        .pred-logo { width: 30px; height: 30px; border-radius: 50%; }

        @keyframes dropDown { from { transform: translateY(-150px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
    </style>
</head>
<body>

    <div id="alive-status">
        <div class="status-box">
            <span class="status-val" id="alive-teams">0</span>
            <div class="status-lbl">Teams Alive</div>
        </div>
        <div class="status-box">
            <span class="status-val" id="alive-players">0</span>
            <div class="status-lbl">Players Alive</div>
        </div>
    </div>

    <div id="elim-container">
        <div class="elim-card">
            <div class="logo-box"><img id="e-logo" src=""></div>
            <div class="info-box">
                <div class="team-name" id="e-name">TEAM NAME</div>
                <div class="status-txt">ELIMINATED</div>
            </div>
            <div class="fin-box">
                <span class="fin-val" id="e-fin">0</span>
                <span style="color:white; font-size:10px;">FINISHES</span>
            </div>
        </div>
    </div>

    <div id="prediction-box">
        <div class="pred-title">WINNING PREDICTION</div>
        <div class="pred-team">
            <img class="pred-logo" id="p-logo" src="https://via.placeholder.com/30">
            <span id="p-name">Calculating...</span>
        </div>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://bgmi-overlay-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let lastElimStr = "";

        db.ref('liveData').on('value', (snap) => {
            if (!snap.exists()) return;
            const data = snap.val();
            const teams = data.teams || [];

            // 1. Calculate Alive Status
            let aliveTeams = 0;
            let alivePlayers = 0;
            teams.forEach(t => {
                const pAlive = t.alive.filter(a => a === 1).length;
                if(pAlive > 0) {
                    aliveTeams++;
                    alivePlayers += pAlive;
                }
            });
            document.getElementById('alive-teams').innerText = aliveTeams;
            document.getElementById('alive-players').innerText = alivePlayers;

            // 2. Elimination Popup Trigger
            if (data.lastEliminated && JSON.stringify(data.lastEliminated) !== lastElimStr) {
                lastElimStr = JSON.stringify(data.lastEliminated);
                triggerElim(data.lastEliminated);
            }

            // 3. Winning Prediction Logic (Highest Finishes + Alive)
            const contenders = teams.filter(t => t.alive.includes(1));
            if(contenders.length > 0) {
                const top = contenders.sort((a,b) => (parseInt(b.fin)||0) - (parseInt(a.fin)||0))[0];
                document.getElementById('p-name').innerText = top.name;
                document.getElementById('p-logo').src = top.logo || 'https://via.placeholder.com/30';
            }
        });

        function triggerElim(data) {
            const el = document.getElementById('elim-container');
            document.getElementById('e-name').innerText = data.name;
            document.getElementById('e-logo').src = data.logo || '';
            document.getElementById('e-fin').innerText = data.finishes || 0;

            el.style.display = 'block';
            el.style.animation = 'dropDown 0.5s ease-out';

            setTimeout(() => {
                el.style.animation = 'fadeOut 0.5s forwards';
                setTimeout(() => { el.style.display = 'none'; }, 500);
            }, 5000);
        }
    </script>
</body>
</html>
