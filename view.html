<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BGMI Pro Production Overlay</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { --cyan: #00f2ff; --dark: #15191d; --row-bg: #1c2227; }
        body { margin: 0; background: #00ff00; font-family: 'Oswald', sans-serif; overflow: hidden; height: 1080px; width: 1920px; }

        /* SIDE ALIVE STATUS (Screenshot 2 Logic) */
        .side-status { position: absolute; top: 50px; left: 20px; width: 350px; background: rgba(11, 14, 17, 0.95); border-radius: 4px; overflow: hidden; }
        .s-header { display: grid; grid-template-columns: 40px 1fr 80px 40px 50px; background: #0b0e11; color: var(--cyan); font-size: 12px; padding: 10px 5px; text-align: center; border-bottom: 2px solid var(--cyan); }
        .s-row { display: grid; grid-template-columns: 40px 1fr 80px 40px 50px; padding: 8px 5px; border-bottom: 1px solid #2d3439; align-items: center; color: white; }
        .s-row.out { opacity: 0.4; filter: grayscale(1); }
        .rank-num { font-weight: bold; color: #5c6b79; }
        .p-bars { display: flex; gap: 3px; justify-content: center; }
        .bar { width: 4px; height: 18px; background: #3e474f; border-radius: 1px; }
        .bar.active { background: var(--cyan); box-shadow: 0 0 5px var(--cyan); }
        .total-box { background: var(--cyan); color: black; font-weight: bold; height: 100%; display: flex; align-items: center; justify-content: center; }

        /* ELIMINATION POPUP (Screenshot 1 Design) */
        #elim-box { position: absolute; top: 100px; left: 50%; transform: translateX(-50%); display: none; }
        .elim-card { display: flex; background: #1c2227; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.6); min-width: 650px; height: 120px; border: 1px solid #2d3439; }
        .e-logo-side { background: white; width: 180px; display: flex; justify-content: center; align-items: center; position: relative; }
        .e-logo-side img { width: 100px; height: 100px; object-fit: contain; }
        .e-info { flex-grow: 1; padding: 20px 30px; display: flex; flex-direction: column; justify-content: center; }
        .e-team-name { color: white; font-size: 45px; text-transform: uppercase; line-height: 1; margin: 0; font-weight: 700; letter-spacing: 1px; }
        .e-status { color: var(--cyan); font-size: 22px; text-transform: uppercase; margin-top: 5px; font-weight: 700; }
        .e-fin-side { background: #2d3439; width: 140px; display: flex; flex-direction: column; justify-content: center; align-items: center; border-left: 1px solid #3e474f; }
        .e-fin-num { font-size: 55px; color: #2b7fff; line-height: 1; font-weight: 700; }
        .e-fin-lbl { color: white; font-size: 16px; margin-top: 5px; font-weight: 500; }

        @keyframes slideIn { from { transform: translate(-50%, -150%); opacity: 0; } to { transform: translate(-50%, 0); opacity: 1; } }
        @keyframes slideOut { from { opacity: 1; } to { opacity: 0; } }
    </style>
</head>
<body>

    <div class="side-status">
        <div class="s-header">
            <div>#</div><div>TEAM NAME</div><div>STATUS</div><div>FIN.</div><div style="background:var(--cyan);color:black">TOTAL</div>
        </div>
        <div id="status-list"></div>
    </div>

    <div id="elim-box">
        <div class="elim-card">
            <div class="e-logo-side"><img id="e-img" src=""></div>
            <div class="e-info">
                <div class="e-team-name" id="e-name">NEW TEAMW</div>
                <div class="e-status">ELIMINATED</div>
            </div>
            <div class="e-fin-side">
                <div class="e-fin-num" id="e-fin">0</div>
                <div class="e-fin-lbl">FINISHES</div>
            </div>
        </div>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://bgmi-overlay-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let lastElimData = "";

        db.ref('liveData').on('value', (snap) => {
            if(!snap.exists()) return;
            const data = snap.val();
            const teams = data.teams || [];

            // Render Side Table (Logic from Screenshot 2)
            const list = document.getElementById('status-list');
            const sorted = teams.map(t => {
                let mPts = t.matches ? t.matches.reduce((a, b) => a + parseInt(b || 0), 0) : 0;
                let total = (parseInt(t.fin)||0) + (parseInt(t.place)||0) + mPts;
                return {...t, total};
            }).sort((a,b) => b.total - a.total);

            list.innerHTML = sorted.map((t, i) => {
                const aliveCount = t.alive ? t.alive.filter(a => a == 1).length : 0;
                const bars = [1,1,1,1].map((_, idx) => `<div class="bar ${idx < aliveCount ? 'active' : ''}"></div>`).join('');
                
                return `
                    <div class="s-row ${aliveCount === 0 ? 'out' : ''}">
                        <div class="rank-num">${i+1}</div>
                        <div style="text-align:left; padding-left:10px; font-weight:700">${t.name}</div>
                        <div class="p-bars">${bars}</div>
                        <div style="text-align:center">${t.fin}</div>
                        <div class="total-box">${t.total}</div>
                    </div>
                `;
            }).join('');

            // Elimination Logic (Logic from Screenshot 1)
            if(data.lastEliminated && JSON.stringify(data.lastEliminated) !== lastElimData) {
                lastElimData = JSON.stringify(data.lastEliminated);
                showElim(data.lastEliminated);
            }
        });

        function showElim(d) {
            const box = document.getElementById('elim-box');
            document.getElementById('e-name').innerText = d.name;
            document.getElementById('e-img').src = d.logo || '';
            document.getElementById('e-fin').innerText = d.finishes || 0;
            
            box.style.display = 'block';
            box.style.animation = 'slideIn 0.5s forwards';
            
            setTimeout(() => {
                box.style.animation = 'slideOut 0.5s forwards';
                setTimeout(() => box.style.display = 'none', 500);
            }, 6000);
        }
    </script>
</body>
</html>
